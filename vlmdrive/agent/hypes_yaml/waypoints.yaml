control:
    control_config: "vlmdrive/controller/hypes_yaml/waypoints.yaml"

# rsu config
RSU:
    change_rsu_frame: 5            # frame gap before a new rsu is spawned
    rsu_height: 7.5                # height of rsu
    rsu_lane_side: 'right'         # location of rsu, on the right/left side of the lane
    rsu_distance: 12               # horizontal distance from rsu to ego vehicle, positive value means foward direction

simulation:
    ego_num: 1                     # number of communicating drivable ego vehicles
    skip_frames: 4                 # frame gap before a new driving control signal is generated

perception: 
    core_method: null
    detection_range: [36, 12, 12, 12] # front rear left right

planning: 
    core_method: 'coopenemma'
    planner_config: "vlmdrive/vlm/hypes_yaml/waypoints.yaml"
    prompt_template:
        scene_prompt_template: 
            default: "You are a autonomous driving vehicle controller. You have access to a front-view camera image.  Describe broadly describes the driving scenarios, including weather, traffic situations, and road conditions."
            llava: "You are a autonomous driving vehicle controller. You have access to a front-view camera images of a vehicle. Based on the lane markings and the movement of other cars and pedestrians, provide a concise description of the desired intent of the ego car. Is it going to follow the lane to turn left, turn right, or go straight? Should it maintain the current speed or slow down or speed up?"
        object_prompt_template: 
            default: "You are a autonomous driving vehicle controller. You have access to a front-view camera image. What other road users should you pay attention to in the driving scene? List two or three of them, specifying its location within the image of the driving scene and provide a short description of the that road user's current status and intent."
        intention_prompt_template: 
            default: "You are a autonomous driving vehicle controller. You have access to a front-view camera image. You should make sure that the vehicle follows the tarffic rules.  The speed limit of the road is 20m/s. You should try to reach the target location as fast as possibly but within the speed limit. You also need to avoid collision with other objects. For example, if there is a car in front of you, you should slow down or change lane to avoid collision. {target_description} Please describe how you would navigate the vehicle to reach the target location. Is it going to follow the lane to turn left, turn right, go straight, slightly go right, slightly go left, accelerate, deaccelerate, or others? Please describe."
        sys_message: null
        target_prompt_template:
            default: "The target is located at {x_distance} meters to your {x_direction} and {y_distance} meters to your {y_direction}. Note that the target is not the end-point, so you don't need to stop at the target. You can keep moving forward after reaching the target."
        comb_prompt: # note the gen_prompts currently needs to modify the code in base_vlm_planner.py
            default: |
                Here is the description of the environment of a car and detected objects around it.
                The scene is described as follows: {scene_description}.  
                The identified critical objects and corresponding intents are {object_description}.  
                The historical information of the ego vehicle is as follows: {ego_history_prompt}.  
                The intent of the ego vehicle is to as follows: {intent_description}.
                {target_description}
                You need to generate vehicle's future waypoints for the next 5 timestamps (0.5s for each timestamps) and ensure these waypoints allow the vehicle to move forward to the target as soon as possible.
                Notice that you will be providing related waypoints, meaning the current position of the vehicle is the origin (0, 0).
                Left indicates negative x, right indicates positive x, front indicates positive y, and back indicates negative y.
                You should make sure that the vehicle follows the tarffic rules. The speed limit of the road is 20m/s. You should try to reach the target location as fast as possibly but within the speed limit. You also need to avoid collision with other objects. For example, if there is a car in front of you, you should slow down or change lane to avoid collision.
                Output MUST be a valid JSON structure with the key \"predicted_waypoints\" containing a list of 5 [x, y] waypoint pairs.
                Make sure it strictly follows this JSON format:
                {{
                    "predicted_waypoints": [
                        [x_1, y_1],
                        [x_2, x_2],
                        ...,
                        [x_5, y_5]
                    ]
                }}
                No additional keys or text outside of this JSON are allowed.
                ```
